<!doctype html>
<html>

<head>
    <meta charset="utf-8">

<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-PN39N8V');</script>

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>How to Build Java Apps with Paketo Buildpacks - Paketo Buildpacks</title>
<meta name="viewport" content="width=device-width, initial-scale=1 viewport-fit=cover">




<meta name="og:site_name" content="Paketo Buildpacks">
<meta name="og:title" content="How to Build Java Apps with Paketo Buildpacks">
<meta name="og:url" content="https://paketo.io/docs/howto/java/">
<meta name="twitter:title" content="Paketo Buildpacks" />
<meta name="twitter:url" content="https://paketo.io/docs/howto/java/" />
<meta name="twitter:card" content="" />



<link rel="stylesheet" href="/css/main.min.5065f2eb0bff7adbb4973defffbefccad8615f9cb38732792628a4f561e3b678.css">

</head>

<body>
    
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PN39N8V"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    

    <div id="header-skip-link" class="screenreader-container">
    <a href="#title" class="screenreader-text">Skip to Content</a>
</div>

    




<header class="header--narrow">
    
    <a class="paketo-p-logo" href="/">
        <img class="paketo-p-logo__image" src="/v2/images/logo-paketo-p.svg" alt="Paketo Buildpacks Homepage">
    </a>
    
    <div id="navigation" class="right-overlay">
        <div class="nav-opener">
            <span class="nav-opener__bar nav-opener__bar-top"></span>
            <span class="nav-opener__bar nav-opener__bar-middle"></span>
            <span class="nav-opener__bar nav-opener__bar-bottom"></span>
        </div>
        <div class="nav-container" id="nav-container">
            <nav class="nav" id="nav-tray" >
                <div class="nav__linkarea text--400">
                    <a class="nav-link" href="/docs">docs</a>
                    <a class="nav-link" href="/community">community</a>
                    <a class="nav-link" href="https://blog.paketo.io">blog</a>
                    <a class="nav-link" href="https://github.com/paketo-buildpacks">github</a>
                </div>
            </nav>
        </div>
    </div>
    <div class="desktop-nav">
        
        
        
        <a class="nav-link nav-link--desktop  nav-link--desktop--active" href="/docs">docs</a>
        
        <a class="nav-link nav-link--desktop   " href="/community">community</a>
        <a class="nav-link nav-link--desktop " href="https://blog.paketo.io">blog</a>
        <a class="nav-link nav-link--desktop " href="https://github.com/paketo-buildpacks">github</a>
    </div>
</header>


    <div class="docs">
    <div class="docs-sidebar">
        
<div id="docs-search" class="docs-search-container" data-app-id="8TYM3HS0CU" data-api-key="0bc69e542f0d93e17450f5984dd611c3" data-index="paketo"/></div>
<div class="docs-menu-container">
    <nav class="docs-menu">
        <ul class="docs-menu__top-level-list">
            
            
                
    
        <li class="docs-menu__leaf">
            <a href="/docs/" class="docs-menu__item docs-menu__link ">
                
                <span>Getting Started</span>
            </a>
        </li>
    
            
                
    
        <li class="docs-menu__item docs-menu__parent">
            
            <div class="docs-menu__section-header docs-menu__section-header--opened">
                
                <span>How To</span>
                <button class="expander-button expander-button--opened docs-menu__expander-button">
                    <svg class="expander-button__triangle expander-button__triangle--opened" width="38" height="34" viewBox="0 0 38 34" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <rect x="0.140625" width="37.0257" height="34" rx="8" fill="#888888" fill-opacity="0.25"/>
                        <path d="M28.1604 13H8.14648L18.6538 22.5L28.1604 13Z" fill="#FEFCFC"/>
                        </svg>
                </button>
            </div>
            
            <ul class="docs-menu__children-list docs-menu__children-list--opened">
                
                    
    
        <li class="docs-menu__leaf">
            <a href="/docs/howto/java/" class="docs-menu__item docs-menu__link docs-menu__link--active">
                
                <span>Java</span>
            </a>
        </li>
    
                
                    
    
        <li class="docs-menu__leaf">
            <a href="/docs/howto/nodejs/" class="docs-menu__item docs-menu__link ">
                
                <span>Node.js</span>
            </a>
        </li>
    
                
                    
    
        <li class="docs-menu__leaf">
            <a href="/docs/howto/dotnet-core/" class="docs-menu__item docs-menu__link ">
                
                <span>.NET Core</span>
            </a>
        </li>
    
                
                    
    
        <li class="docs-menu__leaf">
            <a href="/docs/howto/go/" class="docs-menu__item docs-menu__link ">
                
                <span>Go</span>
            </a>
        </li>
    
                
                    
    
        <li class="docs-menu__leaf">
            <a href="/docs/howto/web-servers/" class="docs-menu__item docs-menu__link ">
                
                <span>Web Servers</span>
            </a>
        </li>
    
                
                    
    
        <li class="docs-menu__leaf">
            <a href="/docs/howto/python/" class="docs-menu__item docs-menu__link ">
                
                <span>Python</span>
            </a>
        </li>
    
                
                    
    
        <li class="docs-menu__leaf">
            <a href="/docs/howto/php/" class="docs-menu__item docs-menu__link ">
                
                <span>PHP</span>
            </a>
        </li>
    
                
                    
    
        <li class="docs-menu__leaf">
            <a href="/docs/howto/ruby/" class="docs-menu__item docs-menu__link ">
                
                <span>Ruby</span>
            </a>
        </li>
    
                
                    
    
        <li class="docs-menu__leaf">
            <a href="/docs/howto/configuration/" class="docs-menu__item docs-menu__link ">
                
                <span>Configure Paketo Buildpacks</span>
            </a>
        </li>
    
                
                    
    
        <li class="docs-menu__leaf">
            <a href="/docs/howto/create-paketo-buildpack/" class="docs-menu__item docs-menu__link ">
                
                <span>Create a Paketo Buildpack</span>
            </a>
        </li>
    
                
                    
    
        <li class="docs-menu__leaf">
            <a href="/docs/howto/sbom/" class="docs-menu__item docs-menu__link ">
                
                <span>Access the SBOM</span>
            </a>
        </li>
    
                
                    
    
        <li class="docs-menu__leaf">
            <a href="/docs/howto/create-custom-stack/" class="docs-menu__item docs-menu__link ">
                
                <span>Create a Custom Stack</span>
            </a>
        </li>
    
                
            </ul>
        </li>
    
            
                
    
        <li class="docs-menu__item docs-menu__parent">
            
            <div class="docs-menu__section-header ">
                
                <span>Concepts</span>
                <button class="expander-button  docs-menu__expander-button">
                    <svg class="expander-button__triangle " width="38" height="34" viewBox="0 0 38 34" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <rect x="0.140625" width="37.0257" height="34" rx="8" fill="#888888" fill-opacity="0.25"/>
                        <path d="M28.1604 13H8.14648L18.6538 22.5L28.1604 13Z" fill="#FEFCFC"/>
                        </svg>
                </button>
            </div>
            
            <ul class="docs-menu__children-list ">
                
                    
    
        <li class="docs-menu__leaf">
            <a href="/docs/concepts/buildpacks/" class="docs-menu__item docs-menu__link ">
                
                <span>Buildpacks</span>
            </a>
        </li>
    
                
                    
    
        <li class="docs-menu__leaf">
            <a href="/docs/concepts/builders/" class="docs-menu__item docs-menu__link ">
                
                <span>Builders</span>
            </a>
        </li>
    
                
                    
    
        <li class="docs-menu__leaf">
            <a href="/docs/concepts/stacks/" class="docs-menu__item docs-menu__link ">
                
                <span>Stacks</span>
            </a>
        </li>
    
                
                    
    
        <li class="docs-menu__leaf">
            <a href="/docs/concepts/sbom/" class="docs-menu__item docs-menu__link ">
                
                <span>Software Bill of Materials (SBOM)</span>
            </a>
        </li>
    
                
            </ul>
        </li>
    
            
                
    
        <li class="docs-menu__item docs-menu__parent">
            
            <div class="docs-menu__section-header ">
                
                <span>Reference</span>
                <button class="expander-button  docs-menu__expander-button">
                    <svg class="expander-button__triangle " width="38" height="34" viewBox="0 0 38 34" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <rect x="0.140625" width="37.0257" height="34" rx="8" fill="#888888" fill-opacity="0.25"/>
                        <path d="M28.1604 13H8.14648L18.6538 22.5L28.1604 13Z" fill="#FEFCFC"/>
                        </svg>
                </button>
            </div>
            
            <ul class="docs-menu__children-list ">
                
                    
    
        <li class="docs-menu__leaf">
            <a href="/docs/reference/httpd-reference/" class="docs-menu__item docs-menu__link ">
                
                <span>HTTPD Buildpack</span>
            </a>
        </li>
    
                
                    
    
        <li class="docs-menu__leaf">
            <a href="/docs/reference/dotnet-core-reference/" class="docs-menu__item docs-menu__link ">
                
                <span>.NET Core Buildpack</span>
            </a>
        </li>
    
                
                    
    
        <li class="docs-menu__leaf">
            <a href="/docs/reference/go-reference/" class="docs-menu__item docs-menu__link ">
                
                <span>Go Buildpack</span>
            </a>
        </li>
    
                
                    
    
        <li class="docs-menu__leaf">
            <a href="/docs/reference/java-reference/" class="docs-menu__item docs-menu__link ">
                
                <span>Java Buildpack</span>
            </a>
        </li>
    
                
                    
    
        <li class="docs-menu__leaf">
            <a href="/docs/reference/java-native-image-reference/" class="docs-menu__item docs-menu__link ">
                
                <span>Java Native Image Buildpack</span>
            </a>
        </li>
    
                
                    
    
        <li class="docs-menu__leaf">
            <a href="/docs/reference/nginx-reference/" class="docs-menu__item docs-menu__link ">
                
                <span>NGINX Buildpack</span>
            </a>
        </li>
    
                
                    
    
        <li class="docs-menu__leaf">
            <a href="/docs/reference/nodejs-reference/" class="docs-menu__item docs-menu__link ">
                
                <span>Node.js Buildpack</span>
            </a>
        </li>
    
                
                    
    
        <li class="docs-menu__leaf">
            <a href="/docs/reference/php-reference/" class="docs-menu__item docs-menu__link ">
                
                <span>PHP Buildpack</span>
            </a>
        </li>
    
                
                    
    
        <li class="docs-menu__leaf">
            <a href="/docs/reference/python-reference/" class="docs-menu__item docs-menu__link ">
                
                <span>Python Buildpack</span>
            </a>
        </li>
    
                
                    
    
        <li class="docs-menu__leaf">
            <a href="/docs/reference/ruby-reference/" class="docs-menu__item docs-menu__link ">
                
                <span>Ruby Buildpack</span>
            </a>
        </li>
    
                
            </ul>
        </li>
    
            
        </ul>
    </nav>
</div>


    </div>
    <div class="docs-mobile-tab">
        <svg width="7" height="39" viewBox="0 0 7 39" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M7 3.5C7 5.433 5.433 7 3.5 7C1.567 7 0 5.433 0 3.5C0 1.567 1.567 0 3.5 0C5.433 0 7 1.567 7 3.5Z" fill="#FEFCFC"/>
            <path d="M7 19.5C7 21.433 5.433 23 3.5 23C1.567 23 0 21.433 0 19.5C0 17.567 1.567 16 3.5 16C5.433 16 7 17.567 7 19.5Z" fill="#FEFCFC"/>
            <path d="M7 35.5C7 37.433 5.433 39 3.5 39C1.567 39 0 37.433 0 35.5C0 33.567 1.567 32 3.5 32C5.433 32 7 33.567 7 35.5Z" fill="#FEFCFC"/>
            </svg>
    </div>
    <div class="docs-body">
        <div class="docs-body__container">
            
  <a href="https://github.com/paketo-buildpacks/paketo-website/edit/main/content/docs/howto/java.md" target="_blank" class="github-edit" style="text-decoration:none">
    <div class="github-edit__content">
      <div class="github-edit__logo-container">
        <img class="github-edit__logo" src="/images/github-mark.png">
      </div>
        <div class="github-edit__text">Edit</div>
    </div>
</a>

            <h1 id="title">How to Build Java Apps with Paketo Buildpacks</h1>
            
<div class="docs-body__table-of-contents-container docs-body__table-of-contents-container--mobile">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#about-the-examples">About the Examples</a></li>
    <li><a href="#build-an-app-as-a-traditional-java-war-or-jar">Build an App as a Traditional Java WAR or JAR</a>
      <ul>
        <li><a href="#build-from-source">Build from Source</a></li>
        <li><a href="#build-from-a-compiled-artifact">Build from a Compiled Artifact</a></li>
        <li><a href="#inspect-the-jvm-version">Inspect the JVM Version</a></li>
        <li><a href="#install-a-specific-jvm-version">Install a Specific JVM Version</a></li>
        <li><a href="#install-a-specific-jvm-type">Install a Specific JVM Type</a></li>
        <li><a href="#configure-the-jvm-at-runtime">Configure the JVM at Runtime</a></li>
        <li><a href="#use-an-alternative-jvm">Use an Alternative JVM</a></li>
        <li><a href="#use-an-alternative-java-application-server">Use an Alternative Java Application Server</a></li>
      </ul>
    </li>
    <li><a href="#build-an-app-as-a-graalvm-native-image-application">Build an App as a GraalVM Native Image Application</a>
      <ul>
        <li><a href="#build-from-source-1">Build From Source</a></li>
        <li><a href="#build-from-an-executable-jar">Build From an Executable JAR</a></li>
        <li><a href="#inspect-the-native-image-tools-version">Inspect the Native Image Tools Version</a></li>
        <li><a href="#configure-the-graalvm-version">Configure the GraalVM Version</a></li>
        <li><a href="#use-an-alternative-java-native-image-toolkit">Use an Alternative Java Native Image Toolkit</a></li>
      </ul>
    </li>
    <li><a href="#build-a-spring-boot-application">Build a Spring Boot Application</a>
      <ul>
        <li><a href="#inspect-spring-boot-application-dependencies">Inspect Spring Boot Application Dependencies</a></li>
        <li><a href="#disable-spring-boot-auto-configuration">Disable Spring Boot Auto-Configuration</a></li>
      </ul>
    </li>
    <li><a href="#connect-to-an-apm">Connect to an APM</a></li>
    <li><a href="#enable-process-reloading">Enable Process Reloading</a>
      <ul>
        <li><a href="#using-tilt-with-paketo-buildpacks">Using Tilt with Paketo Buildpacks</a></li>
      </ul>
    </li>
    <li><a href="#enable-remote-debugging">Enable Remote Debugging</a></li>
    <li><a href="#enable-jmx">Enable JMX</a></li>
    <li><a href="#enable-java-native-memory-tracking-nmt">Enable Java Native Memory Tracking (NMT)</a>
      <ul>
        <li><a href="#java-nmt-and-java-8">Java NMT and Java 8</a></li>
        <li><a href="#java-nmt-and-reloadable-processes">Java NMT and Reloadable Processes</a></li>
      </ul>
    </li>
    <li><a href="#enable-java-flight-recorder-jfr">Enable Java Flight Recorder (JFR)</a></li>
    <li><a href="#append-arguments-to-the-apps-start-command">Append Arguments to the App&rsquo;s Start Command</a></li>
    <li><a href="#provide-a-custom-start-command-at-launch">Provide a Custom Start Command at Launch</a>
      <ul>
        <li><a href="#execute-a-custom-command-in-the-buildpack-provided-environment">Execute a Custom Command in the Buildpack-Provided Environment</a></li>
      </ul>
    </li>
  </ul>
</nav>
</div>

            <div class="docs-body__markdown">
                <p>This documentation explains how to use the Paketo buildpacks
to build Java applications for several common use-cases. For more in-depth
description of the buildpacks&rsquo; behavior and configuration see the <a href="https://paketo.io/docs/reference/java-reference/">Paketo Java Buildpack</a> and <a href="https://paketo.io/docs/reference/java-native-image-reference/">Paketo Java Native Image Buildpack</a> reference documentation.</p>
<h2 id="about-the-examples" class="markup-heading">
    <a class="markup-heading__link" href="#about-the-examples">
        About the Examples
    </a>
</h2><p>All Java Buildpack examples will use the Paketo <a href="https://github.com/paketo-buildpacks/samples">sample applications</a>.</p>
<p>Examples assume that the root of this repository is the working directory:
<div class="copyable">
    <pre class="copyable__code">git clone https://github.com/paketo-buildpacks/samples
cd samples
</pre>
    <img class="copyable__clipboard" src="/images/clipboard.svg" alt="copy to clipboard" />
    <div class="copyable__copied copied">Copied!</div>
</div></p>
<p>The <a href="https://github.com/buildpacks/pack">pack CLI</a> is used throughout the examples. <code>pack</code> is just one of several Cloud Native Buildpack <a href="https://buildpacks.io/docs/concepts/components/platform/">platforms</a> than can execute builds with the Java Buildpacks. For example, Spring Boot developers may want to explore the <a href="https://docs.spring.io/spring-boot/docs/current/maven-plugin/reference/html/#build-image">Spring Boot Maven Plugin</a> or <a href="https://docs.spring.io/spring-boot/docs/current/gradle-plugin/reference/html/#build-image">Spring Boot Gradle Plugin</a> .</p>
<p>Examples assume that the <a href="https://paketo.io/docs/concepts/builders/#base">Paketo Base builder</a> is the default builder:
<div class="copyable">
    <pre class="copyable__code">pack config default-builder paketobuildpacks/builder:base
</pre>
    <img class="copyable__clipboard" src="/images/clipboard.svg" alt="copy to clipboard" />
    <div class="copyable__copied copied">Copied!</div>
</div></p>
<p>All java example images should return <code>{&quot;status&quot;:&quot;UP&quot;}</code> from the <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/actuator.html#actuator.endpoints">actuator health endpoint</a>.
<div class="copyable">
    <pre class="copyable__code">docker run --rm --tty --publish 8080:8080 samples/java
curl -s http://localhost:8080/actuator/health | jq .
</pre>
    <img class="copyable__clipboard" src="/images/clipboard.svg" alt="copy to clipboard" />
    <div class="copyable__copied copied">Copied!</div>
</div></p>
<h2 id="build-an-app-as-a-traditional-java-war-or-jar" class="markup-heading">
    <a class="markup-heading__link" href="#build-an-app-as-a-traditional-java-war-or-jar">
        Build an App as a Traditional Java WAR or JAR
    </a>
</h2><h3 id="build-from-source" class="markup-heading">
    <a class="markup-heading__link" href="#build-from-source">
        Build from Source
    </a>
</h3><p>The Java Buildpack can build from source using any of the following build tools:</p>
<ul>
<li><a href="https://gradle.org/">Gradle</a> - Support provided by the <a href="https://github.com/paketo-buildpacks/gradle">Gradle Buildpack</a></li>
</ul>
<!-- raw HTML omitted -->
<ul>
<li><a href="https://leiningen.org/">Leiningen</a> - Support provided by the <a href="https://github.com/paketo-buildpacks/leiningen">Leiningen Buildpack</a></li>
<li><a href="https://maven.apache.org/">Maven</a> - Support provided by the <a href="https://github.com/paketo-buildpacks/maven">Maven Buildpack</a></li>
<li><a href="https://www.scala-sbt.org/index.html">SBT</a> - Support provided by the <a href="https://github.com/paketo-buildpacks/sbt">SBT Buildpack</a></li>
</ul>
<!-- raw HTML omitted -->
<p>The correct build tool to use will be detected based on the contents of the
application directory.</p>
<p>The build should produce one the of <a href="#build-from-a-compiled-artifact">supported artifact
formats</a>. After building, the buildpack
will replace provided application source code with the exploded archive. The
build will proceed as described in <a href="#build-from-a-compiled-artifact">Building from a Compiled
Artifact</a>.</p>
<p><strong>Example</strong>: Building with Maven</p>
<p>The following command creates an image from source with <code>maven</code>.</p>
<div class="copyable">
    <pre class="copyable__code">pack build samples/java \
  --path java/maven
</pre>
    <img class="copyable__clipboard" src="/images/clipboard.svg" alt="copy to clipboard" />
    <div class="copyable__copied copied">Copied!</div>
</div>
<h4 id="configure-the-build-tool" class="markup-heading">
    <a class="markup-heading__link" href="#configure-the-build-tool">
        Configure the Build Tool
    </a>
</h4><p><strong>Note</strong>: The following set of configuration options are not comprehensive, see the homepage for the relevant component buildpacks for a full-set of configuration options.</p>
<h5 id="select-a-module-or-artifact" class="markup-heading">
    <a class="markup-heading__link" href="#select-a-module-or-artifact">
        Select a Module or Artifact
    </a>
</h5><p>For a given build <code>&lt;TOOL&gt;</code>, where <code>&lt;TOOL&gt;</code> is one of <code>MAVEN</code>, <code>GRADLE</code>, <code>LEIN</code> or <code>SBT</code>, the selected artifact can be configured with one of the following environment variable at build-time:</p>
<ul>
<li><code>BP_&lt;TOOL&gt;_BUILT_MODULE</code>
<ul>
<li><em>Defaults</em> to the root module.</li>
<li>Configures the module in a multi-module build from which the buildpack will select the application artifact.</li>
<li><em>Example</em>: Given <code>BP_MAVEN_BUILT_MODULE=api</code>, Paketo Maven Buildpack will look for the application artifact with the file pattern <code>target/api/*.[jw]ar</code>.</li>
</ul>
</li>
<li><code>BP_&lt;TOOL&gt;_BUILT_ARTIFACT</code>
<ul>
<li>Defaults to a tool-specific pattern (e.g. <code>target/*.[jw]ar</code> for Maven, <code>build/libs/*.[jw]ar</code> for gradle). See component buildpack homepage for details.</li>
<li>Configures the built application artifact path, using <a href="https://www.gnu.org/software/bash/manual/html_node/Pattern-Matching.html">Bash Pattern Matching</a>.</li>
<li>Supersedes<code>BP_&lt;TOOL&gt;_BUILT_MODULE</code> if set to a non-default value.</li>
<li><em>Example</em>: Given <code>BP_MAVEN_BUILT_ARTIFACT=out/api-*.jar</code>, the Paketo Maven Buildpack will select a file with name <code>out/api-1.0.0.jar</code>.</li>
</ul>
</li>
</ul>
<h5 id="specify-the-build-command" class="markup-heading">
    <a class="markup-heading__link" href="#specify-the-build-command">
        Specify the Build Command
    </a>
</h5><p>For a given build <code>&lt;TOOL&gt;</code>, where <code>&lt;TOOL&gt;</code> is one of <code>MAVEN</code>, <code>GRADLE</code>, <code>LEIN</code> or <code>SBT</code>, the build command can be configured with the following environment variable at build-time:</p>
<ul>
<li><code>BP_&lt;TOOL&gt;_BUILD_ARGUMENTS</code>
<ul>
<li><em>Defaults</em> to a tool-specific value (e.g. <code>-Dmaven.test.skip=true package</code> for Maven, <code>--no-daemon assemble</code> for Gradle). See component buildpack homepage for details.</li>
<li>Configures the arguments to pass to the build tool.</li>
<li><em>Example</em>: Given <code>BP_GRADLE_BUILD_ARGUMENTS=war</code>, the Paketo Gradle Buildpack will execute <code>./gradlew war</code> or <code>gradle war</code> (depending on the presence of the gradle wrapper).</li>
</ul>
</li>
</ul>
<h5 id="connect-to-a-private-maven-repository" class="markup-heading">
    <a class="markup-heading__link" href="#connect-to-a-private-maven-repository">
        Connect to a Private Maven Repository
    </a>
</h5><p>A <a href="https://paketo.io/docs/howto/configuration/#bindings">binding</a> with type <code>maven</code> and key <code>settings.xml</code> can be used to provide custom <a href="https://maven.apache.org/settings.html">Maven settings</a>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-plain" data-lang="plain"><span class="line"><span class="cl">&lt;binding-name&gt;
</span></span><span class="line"><span class="cl">├── settings.xml
</span></span><span class="line"><span class="cl">└── type
</span></span></code></pre></div><p>The value of <code>settings.xml</code> file may contain the credentials needed to connect to a private Maven repository.</p>
<p><strong>Example</strong>: Providing Maven Settings</p>
<p>The following steps demonstrate how to use a <code>settings.xml</code> file from your workstation with <code>pack</code>.</p>
<ol>
<li>
<p>Create a directory to contain the binding.
<div class="copyable">
    <pre class="copyable__code">mkdir java/maven/binding
</pre>
    <img class="copyable__clipboard" src="/images/clipboard.svg" alt="copy to clipboard" />
    <div class="copyable__copied copied">Copied!</div>
</div></p>
</li>
<li>
<p>Indicate that the binding is of type <code>maven</code> with a file called <code>type</code> inside the binding, containing the value <code>maven</code>.
<div class="copyable">
    <pre class="copyable__code">echo -n &#34;maven&#34; &gt; java/maven/binding/type
</pre>
    <img class="copyable__clipboard" src="/images/clipboard.svg" alt="copy to clipboard" />
    <div class="copyable__copied copied">Copied!</div>
</div></p>
</li>
<li>
<p>Copy the <code>settings.xml</code> file from the workstation to the binding.
<div class="copyable">
    <pre class="copyable__code">cp ~/.m2/settings.xml java/maven/binding/settings.xml
</pre>
    <img class="copyable__clipboard" src="/images/clipboard.svg" alt="copy to clipboard" />
    <div class="copyable__copied copied">Copied!</div>
</div></p>
</li>
<li>
<p>Provide the binding to <code>pack build</code>.
<div class="copyable">
    <pre class="copyable__code">pack build samples/java \
   --path java/maven \
   --volume $(pwd)/java/maven/binding:/platform/bindings/my-maven-settings
</pre>
    <img class="copyable__clipboard" src="/images/clipboard.svg" alt="copy to clipboard" />
    <div class="copyable__copied copied">Copied!</div>
</div></p>
</li>
</ol>
<h5 id="share-local-maven-or-gradle-cache" class="markup-heading">
    <a class="markup-heading__link" href="#share-local-maven-or-gradle-cache">
        Share Local Maven or Gradle Cache
    </a>
</h5><p>If you have been developing your code on your computer, it&rsquo;s very likely that Maven or Gradle have already downloaded all of the dependency JARs required to build your application. However, if you perform a <code>pack build</code> of your application this runs in a new container and does not by default have access to your existing Maven or Gradle cache. This means Maven and Gradle will helpfully download all of the dependencies they require again, slowing down your builds.</p>
<p>You can speed up builds by sharing your local Maven or Gradle cache with the container.</p>
<p>To do this with <code>pack</code>, you need to add the flag <code>--volume $HOME/.m2:/home/cnb/.m2:rw</code> to your <code>pack build</code> command. This flag will volume mount your local Maven directory into the build container so it can be used there. This command makes the volume mount read-write, which allows Maven running inside the container to download and persist additional dependencies. If you do not want this, you can make the mount read-only by changing <code>:rw</code> to <code>:ro</code>. If read-only and Maven requires a dependency not present, the build will fail.</p>
<p>You may do the same thing with Gradle, the flag to add is <code>--volume $HOME/.gradle:/home/cnb/.gradle:rw</code>. Again, you make change <code>:rw</code> to <code>:ro</code> if you prefer the mount to be read-only.</p>
<p>For example:</p>
<div class="copyable">
    <pre class="copyable__code">pack build samples/java \
  --path java/maven \
  --volume $HOME/.m2:/home/cnb/.m2:rw
</pre>
    <img class="copyable__clipboard" src="/images/clipboard.svg" alt="copy to clipboard" />
    <div class="copyable__copied copied">Copied!</div>
</div>
<p>or</p>
<div class="copyable">
    <pre class="copyable__code">pack build samples/java \
  --path java/gradle \
  --volume $HOME/.gradle:/home/cnb/.gradle:rw
</pre>
    <img class="copyable__clipboard" src="/images/clipboard.svg" alt="copy to clipboard" />
    <div class="copyable__copied copied">Copied!</div>
</div>
<p><strong>DO NOT</strong> use this option if <a href="#connect-to-a-private-maven-repository">including a Maven or Gradle binding</a>! If you do this, it will overwrite your actual local config file with the binding file which could cause data loss. It is also unnecessary because we are volume mounting the entire Maven or Gradle directory into the container which includes your Maven and Gradle settings.</p>
<h3 id="build-from-a-compiled-artifact" class="markup-heading">
    <a class="markup-heading__link" href="#build-from-a-compiled-artifact">
        Build from a Compiled Artifact
    </a>
</h3><p>An application developer may build an image from following archive formats:</p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/JAR_(file_format)#Executable_JAR_files">Executable JAR</a> - Support provided by the <a href="https://github.com/paketo-buildpacks/executable-jar">Executable Jar Buildpack</a></li>
</ul>
<!-- raw HTML omitted -->
<ul>
<li><a href="https://en.wikipedia.org/wiki/WAR_(file_format)">WAR</a> - Support provided by the <a href="https://github.com/paketo-buildpacks/apache-tomcat">Apache Tomcat Buildpack</a></li>
<li><a href="https://docs.gradle.org/current/userguide/distribution_plugin.html">Distribution ZIP</a> - Support provided by the <a href="https://github.com/paketo-buildpacks/dist-zip">DistZip Buildpack</a></li>
</ul>
<p>The Java Buildpack expects the application directory to contain the extracted contents of the archive (e.g. an exploded JAR). Most platforms will automatically extract any provided archives.</p>
<p>If a WAR is detect the Java Buildpack will install <a href="https://tomcat.apache.org">Apache Tomcat</a>. For exact set of supported Tomcat versions can be found in the Java Buildpack <a href="https://github.com/paketo-buildpacks/java/releases">releases notes</a>. For tomcat configuration options see the <a href="https://github.com/paketo-buildpacks/apache-tomcat">Apache Tomcat Buildpack</a>.</p>
<!-- raw HTML omitted -->
<p>The component buildpack for the provided artifact format will contribute a start command to the image.</p>
<p><em>Note</em>: All three of the <a href="https://github.com/paketo-buildpacks/apache-tomcat">Apache Tomcat Buildpack</a>,
<a href="https://github.com/paketo-buildpacks/executable-jar">Executable Jar Buildpack</a>, and <a href="https://github.com/paketo-buildpacks/dist-zip">DistZip
Buildpack</a> may opt-in during detection. However, only one of these
buildpacks will actually contribute to the final image. This happens because
the artifact type may be unknown during detection, if for example a previous
buildpack <a href="#build-from-source">compiles the artifact</a>.</p>
<p><strong>Example</strong>: Building from an Executable JAR</p>
<p>The following command uses Maven to compile an executable JAR and then uses <code>pack</code> to build an image from the JAR.</p>
<div class="copyable">
    <pre class="copyable__code">cd java/maven
./mvnw package
pack build samples/java \
   --path /target/demo-0.0.1-SNAPSHOT.jar
</pre>
    <img class="copyable__clipboard" src="/images/clipboard.svg" alt="copy to clipboard" />
    <div class="copyable__copied copied">Copied!</div>
</div>
<p>The resulting application image will be identical to that built in the Building with Maven example.</p>
<h3 id="inspect-the-jvm-version" class="markup-heading">
    <a class="markup-heading__link" href="#inspect-the-jvm-version">
        Inspect the JVM Version
    </a>
</h3><p>The exact JRE version that was contributed to a given image can be read from the Bill-of-Materials.</p>
<p><strong>Example</strong> Inspecting the JRE Version</p>
<p>Given an image named <code>samples/java</code> built from one of examples above, the following command should print the exact version of the installed JRE.
<div class="copyable">
    <pre class="copyable__code">pack inspect-image samples/app --bom | jq &#39;.local[] | select(.name==&#34;jre&#34;) | .metadata.version&#39;
</pre>
    <img class="copyable__clipboard" src="/images/clipboard.svg" alt="copy to clipboard" />
    <div class="copyable__copied copied">Copied!</div>
</div></p>
<h3 id="install-a-specific-jvm-version" class="markup-heading">
    <a class="markup-heading__link" href="#install-a-specific-jvm-version">
        Install a Specific JVM Version
    </a>
</h3><p>The following environment variable configures the JVM version at build-time.</p>
<ul>
<li><code>BP_JVM_VERSION</code>
<ul>
<li>Defaults to the latest 11.x version at the time of release.</li>
<li>Configures a specific JDK or JRE version (specify only the major version).</li>
<li><em>Example</em>: Given <code>BP_JVM_VERSION=8</code> or <code>BP_JVM_VERSION=8.*</code> the buildpack will install the latest patch releases of the Java 8 JDK and JRE.</li>
</ul>
</li>
</ul>
<h3 id="install-a-specific-jvm-type" class="markup-heading">
    <a class="markup-heading__link" href="#install-a-specific-jvm-type">
        Install a Specific JVM Type
    </a>
</h3><p>The following environment variable configures whether a JDK or a JRE is installed at runtime.</p>
<ul>
<li><code>BP_JVM_TYPE</code>
<ul>
<li>Defaults to <code>JRE</code> - a JDK will be used at build-time and a JRE will be used at runtime. If no JRE dependency is found, a <code>JDK</code> will be installed for use as the JRE.</li>
<li>If <code>JDK</code> is specified, the buildpack will attempt to install a JDK for use at runtime. The security implications of using a JDK at runtime should be considered.</li>
</ul>
</li>
</ul>
<h3 id="configure-the-jvm-at-runtime" class="markup-heading">
    <a class="markup-heading__link" href="#configure-the-jvm-at-runtime">
        Configure the JVM at Runtime
    </a>
</h3><p>The Java Buildpack configures the JVM by setting <code>JAVA_TOOL_OPTIONS</code> in the JVM environment.</p>
<p>The runtime JVM can be configured in two ways:</p>
<ol>
<li>
<p>Buildpack-provided runtime components including the Memory Calculator accept semantically named environment variables which are then used to derive <code>JAVA_TOOL_OPTIONS</code> flags. Examples include:</p>
<ul>
<li><code>BPL_JVM_HEAD_ROOM</code></li>
<li><code>BPL_JVM_LOADED_CLASS_COUNT</code></li>
<li><code>BPL_JVM_THREAD_COUNT</code></li>
</ul>
</li>
<li>
<p>Flags can be set directly at runtime with the <code>JAVA_TOOL_OPTIONS</code> environment variable. User-provided flags will be appended to buildpack-provided flags. If the user and a buildpack set the same flag, user-provided flags take precedence.</p>
</li>
</ol>
<p>See the <a href="https://github.com/paketo-buildpacks/bellsoft-liberica">homepage</a> for the BellSoft Liberica Buildpack for a full set of configuration options.</p>
<p>For example, you can add additional JVM flags to configure garbage collection, memory flags and other settings.</p>
<!-- raw HTML omitted -->
<div class="copyable">
    <pre class="copyable__code">docker run --rm --tty \
  --env JAVA_TOOL_OPTIONS=&#39;-XX:&#43;UseParallelGC -XX:GCTimeRatio=4 -XX:AdaptiveSizePolicyWeight=90 -XX:MinHeapFreeRatio=20 -XX:MaxHeapFreeRatio=40&#39; \
  --env BPL_JVM_THREAD_COUNT=100
  samples/java
</pre>
    <img class="copyable__clipboard" src="/images/clipboard.svg" alt="copy to clipboard" />
    <div class="copyable__copied copied">Copied!</div>
</div>
<!-- raw HTML omitted -->
<h3 id="use-an-alternative-jvm" class="markup-heading">
    <a class="markup-heading__link" href="#use-an-alternative-jvm">
        Use an Alternative JVM
    </a>
</h3><p>By default, the <a href="https://github.com/paketo-buildpacks/java">Paketo Java buildpack</a> will use the Liberica JVM. The following Paketo JVM buildpacks may be used to substitute alternate JVM implementations in place of Liberica&rsquo;s JVM.</p>
<!-- raw HTML omitted -->
<table>
<thead>
<tr>
<th>JVM</th>
<th>Buildpack</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://adoptium.net/">Adoptium</a> <span class="sup">1</span>
</td>
<td><a href="https://github.com/paketo-buildpacks/adoptium">Paketo Adoptium Buildpack</a></td>
</tr>
<tr>
<td><a href="https://github.com/alibaba/dragonwell8">Alibaba Dragonwell</a> <span class="sup">2</span>
</td>
<td><a href="https://github.com/paketo-buildpacks/alibaba-dragonwell">Paketo Alibaba Dragonwell Buildpack</a></td>
</tr>
<tr>
<td><a href="https://aws.amazon.com/corretto/">Amazon Corretto</a> <span class="sup">2</span>
</td>
<td><a href="https://github.com/paketo-buildpacks/amazon-corretto">Paketo Amazon Corretto Buildpack</a></td>
</tr>
<tr>
<td><a href="https://www.azul.com/downloads/zulu-community/">Azul Zulu</a></td>
<td><a href="https://github.com/paketo-buildpacks/azul-zulu">Paketo Azul Zulu Buildpack</a></td>
</tr>
<tr>
<td><a href="https://bell-sw.com/pages/libericajdk/">BellSoft Liberica</a></td>
<td><a href="https://github.com/paketo-buildpacks/bellsoft-liberica">Paketo BellSoft Liberica Buildpack - Default</a></td>
</tr>
<tr>
<td><a href="https://www.eclipse.org/openj9/">Eclipse OpenJ9</a></td>
<td><a href="https://github.com/paketo-buildpacks/eclipse-openj9">Paketo Eclipse OpenJ9 Buildpack</a></td>
</tr>
<tr>
<td><a href="https://www.graalvm.org/">GraalVM</a> <span class="sup">2</span>
</td>
<td><a href="https://github.com/paketo-buildpacks/graalvm">Paketo GraalVM Buildpack</a></td>
</tr>
<tr>
<td><a href="https://www.oracle.com/java/technologies/downloads/">Oracle JDK</a> <span class="sup">2</span>
 <span class="sup">3</span>
</td>
<td><a href="https://github.com/paketo-buildpacks/oracle">Paketo Oracle Buildpack</a></td>
</tr>
<tr>
<td><a href="https://www.microsoft.com/openjdk">Microsoft OpenJDK</a> <span class="sup">2</span>
</td>
<td><a href="https://github.com/paketo-buildpacks/microsoft-openjdk">Paketo Microsoft OpenJDK Buildpack</a></td>
</tr>
<tr>
<td><a href="https://sap.github.io/SapMachine/">SapMachine</a></td>
<td><a href="https://github.com/paketo-buildpacks/sap-machine">Paketo SapMachine Buildpack</a></td>
</tr>
</tbody>
</table>
<!-- raw HTML omitted -->
<ol>
<li><em><span class="sub">Only provides JRE and JDK releases for Java 8 and 11, Java 16+ is JDK only</span>
</em></li>
<li><em><span class="sub">Only provides JDK releases</span>
</em></li>
<li><em><span class="sub">Only provides Java 17</span>
</em></li>
</ol>
<p>To use an alternative JVM, you will need to set two <code>--buildpack</code> arguments to <code>pack build</code>, one for the alternative JVM buildpack you&rsquo;d like to use and one for the Paketo Java buildpack (in that order). This works because while you end up with two JVM buildpacks, the first one, the one you&rsquo;re specifying will claim the build plan entries so the second one will end up being a no-op and doing nothing.</p>
<p>This example will switch in the Azul Zulu buildpack:</p>
<div class="copyable">
    <pre class="copyable__code">pack build samples/jar --buildpack paketo-buildpacks/azul-zulu --buildpack paketo-buildpacks/java`
</pre>
    <img class="copyable__clipboard" src="/images/clipboard.svg" alt="copy to clipboard" />
    <div class="copyable__copied copied">Copied!</div>
</div>
<p>There is one drawback to this approach. When using the method above to specify an alternative JVM vendor buildpack, this alternate buildpack ends up running before the CA certs buildpack and therefore traffic from the alternate JVM vendor buildpack won’t trust any additional CA certs. This is not expected to impact many users because JVM buildpacks should reach out to URLs that have a cert signed by a known authority with a CA in the default system truststore.</p>
<p>If you have customized your JVM buildpack to download the JVM from a URL that uses a certificate not signed by a well-known CA, you can workaround this by specifying the CA certs buildpack to run first. This works because while you will end up with the CA certificates buildpack specified twice, the lifecycle is smart enough to drop the second one.</p>
<p>For example:</p>
<div class="copyable">
    <pre class="copyable__code">pack build samples/jar --buildpack paketo-buildpacks/ca-certificates --buildpack paketo-buildpacks/azul-zulu --buildpack paketo-buildpacks/java`
</pre>
    <img class="copyable__clipboard" src="/images/clipboard.svg" alt="copy to clipboard" />
    <div class="copyable__copied copied">Copied!</div>
</div>
<p>It does not hurt to use this command for all situations, it is just more verbose and most users can get away without specifying the CA certificates buildpack to be first.</p>
<h3 id="use-an-alternative-java-application-server" class="markup-heading">
    <a class="markup-heading__link" href="#use-an-alternative-java-application-server">
        Use an Alternative Java Application Server
    </a>
</h3><p>When deploying your Java application to an application server, the default application server installed by the Paketo Java buildpack is Apache Tomcat. If you require a different application server, possibly one that supports JavaEE or JakartaEE, you may select an alternative Java application server by setting <code>BP_JAVA_APP_SERVER</code> when building your application.</p>
<table>
<thead>
<tr>
<th>Application Server</th>
<th>BP_JAVA_APP_SERVER</th>
<th>Buildpack</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://tomcat.apache.org">Apache Tomcat</a></td>
<td><code>tomcat</code></td>
<td><a href="https://github.com/paketo-buildpacks/apache-tomcat">Paketo Apache Tomcat</a> - Default</td>
</tr>
<tr>
<td><a href="https://tomee.apache.org">Apache Tomee</a></td>
<td><code>tomee</code></td>
<td><a href="https://github.com/paketo-buildpacks/apache-tomee">Paketo Apache Tomee</a></td>
</tr>
<tr>
<td><a href="https://openliberty.io/">Open Liberty</a></td>
<td><code>liberty</code></td>
<td><a href="https://github.com/paketo-buildpacks/liberty">Paketo Liberty</a></td>
</tr>
</tbody>
</table>
<p>This example will switch to using Open Liberty:</p>
<div class="copyable">
    <pre class="copyable__code">pack build samples/war -e BP_JAVA_APP_SERVER=liberty
</pre>
    <img class="copyable__clipboard" src="/images/clipboard.svg" alt="copy to clipboard" />
    <div class="copyable__copied copied">Copied!</div>
</div>
<h2 id="build-an-app-as-a-graalvm-native-image-application" class="markup-heading">
    <a class="markup-heading__link" href="#build-an-app-as-a-graalvm-native-image-application">
        Build an App as a GraalVM Native Image Application
    </a>
</h2><p>The <a href="https://github.com/paketo-buildpacks/java-native-image">Paketo Java Native Image Buildpack</a> allows users to create an image containing a <a href="https://www.graalvm.org/docs/introduction/">GraalVM</a> <a href="https://www.graalvm.org/reference-manual/native-image/">native image</a> application.</p>
<p>The Java Native Buildpack is a <a href="https://paketo.io/docs/concepts/buildpacks/#composite-buildpacks">composite buildpack</a> and
each step in a build is handled by one of its <a href="https://paketo.io/docs/reference/java-native-image-reference/#components">components</a>. The
following docs describe common build configurations. For a full set of
configuration options and capabilities see the homepages of the component
buildpacks.</p>
<h3 id="build-from-source-1" class="markup-heading">
    <a class="markup-heading__link" href="#build-from-source-1">
        Build From Source
    </a>
</h3><p>The Java Native Image Buildpack supports the same <a href="https://paketo.io/docs/howto/java/#build-from-source">build tools and
configuration options</a> as the <a href="https://github.com/paketo-buildpacks/java">Java
Buildpack</a>. The build must produce an <a href="https://en.wikipedia.org/wiki/JAR_(file_format)#Executable_JAR_files">executable jar</a>.</p>
<p>After compiling and packaging, the buildpack will replace provided application
source code with the exploded JAR and proceed as described in <a href="#build-from-an-executable-jar">Building from an
Executable Jar</a>.</p>
<p><strong>Example</strong>: Building a Native image with Maven</p>
<p>The following command creates an image from source with <code>maven</code>.</p>
<div class="copyable">
    <pre class="copyable__code">pack build samples/java-native \
  --env BP_NATIVE_IMAGE=true
  --path java/native-image/java-native-image-sample
</pre>
    <img class="copyable__clipboard" src="/images/clipboard.svg" alt="copy to clipboard" />
    <div class="copyable__copied copied">Copied!</div>
</div>
<h3 id="build-from-an-executable-jar" class="markup-heading">
    <a class="markup-heading__link" href="#build-from-an-executable-jar">
        Build From an Executable JAR
    </a>
</h3><p>An application developer may build an image from an exploded <a href="https://en.wikipedia.org/wiki/JAR_(file_format)#Executable_JAR_files">executable JAR</a>. Most platforms will automatically extract provided archives.</p>
<p><strong>Example</strong>: Building a Native image from an Executable JAR</p>
<p>The following command uses Maven directly to compile an executable JAR and then uses the <code>pack</code> CLI to build an image from the JAR.</p>
<div class="copyable">
    <pre class="copyable__code">cd samples/java/native-image
./mvnw package
pack build samples/java-native \
  --env BP_NATIVE_IMAGE=true
  --path java/native-image/java-native-image-sample/target/demo-0.0.1-SNAPSHOT.jar
</pre>
    <img class="copyable__clipboard" src="/images/clipboard.svg" alt="copy to clipboard" />
    <div class="copyable__copied copied">Copied!</div>
</div>
<p>The resulting application image will be identical to that built in the &ldquo;Building a Native image with Maven&rdquo; example.</p>
<h3 id="inspect-the-native-image-tools-version" class="markup-heading">
    <a class="markup-heading__link" href="#inspect-the-native-image-tools-version">
        Inspect the Native Image Tools Version
    </a>
</h3><p>The exact substrate VM version that was contributed to a given image can be read from the Bill-of-Materials.</p>
<p><strong>Example</strong> Inspecting the JRE Version</p>
<p>Given an image named <code>samples/java-native</code> built from one of examples above, the following command will print the exact version of the installed substrate VM.
<div class="copyable">
    <pre class="copyable__code">pack inspect-image samples/java-native --bom | jq &#39;.local[] | select(.name==&#34;native-image-svm&#34;) | .metadata.version&#39;
</pre>
    <img class="copyable__clipboard" src="/images/clipboard.svg" alt="copy to clipboard" />
    <div class="copyable__copied copied">Copied!</div>
</div></p>
<h3 id="configure-the-graalvm-version" class="markup-heading">
    <a class="markup-heading__link" href="#configure-the-graalvm-version">
        Configure the GraalVM Version
    </a>
</h3><p>Because GraalVM is evolving rapidly you may on occasion need to, for compatibility reasons, select a specific version of the GraalVM and associated tools to use when building an image. This is not a directly configurable option like the JVM version, however, you can pick a specific version by changing the version of the Java Native Image Buildpack you use.</p>
<p>The following table documents the versions available.</p>
<table>
<thead>
<tr>
<th>GraalVM Version</th>
<th>Java Native Image Buildpack Version</th>
</tr>
</thead>
<tbody>
<tr>
<td>21.3</td>
<td>5.12.0</td>
</tr>
<tr>
<td>21.2</td>
<td>5.5.0</td>
</tr>
<tr>
<td>21.1</td>
<td>5.4.0</td>
</tr>
<tr>
<td>21.0</td>
<td>5.3.0</td>
</tr>
</tbody>
</table>
<p>For example, to select GraalVM 21.1:</p>
<div class="copyable">
    <pre class="copyable__code">pack build samples/native -e BP_NATIVE_IMAGE=true --buildpack paketo-buildpacks/ca-certificates --buildpack paketo-buildpacks/java-native-image@5.4.0
</pre>
    <img class="copyable__clipboard" src="/images/clipboard.svg" alt="copy to clipboard" />
    <div class="copyable__copied copied">Copied!</div>
</div>
<h3 id="use-an-alternative-java-native-image-toolkit" class="markup-heading">
    <a class="markup-heading__link" href="#use-an-alternative-java-native-image-toolkit">
        Use an Alternative Java Native Image Toolkit
    </a>
</h3><p>By default, the <a href="https://github.com/paketo-buildpacks/java-native-image">Paketo Java Native Image buildpack</a> will use BellSoft&rsquo;s Native Image Toolkit. The following Paketo JVM buildpacks may be used to substitute alternate Native Image Toolkit implementations in place of the default.</p>
<table>
<thead>
<tr>
<th>JVM</th>
<th>Buildpack</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://bell-sw.com/pages/liberica-native-image-kit/">BellSoft Liberica</a></td>
<td><a href="https://github.com/paketo-buildpacks/bellsoft-liberica">Paketo BellSoft Liberica Buildpack</a></td>
</tr>
<tr>
<td><a href="https://www.graalvm.org/docs/introduction/">GraalVM</a></td>
<td><a href="https://github.com/paketo-buildpacks/graalvm">Paketo GraalVM Buildpack</a></td>
</tr>
</tbody>
</table>
<p>To use an alternative Java Native Image Toolkit, you will need to set two <code>--buildpack</code> arguments to <code>pack build</code>, one for the alternative Java Native Image Toolkit buildpack you&rsquo;d like to use and one for the Paketo Java Native Image buildpack (in that order). This works because while you end up with two Java Native Image Toolkit buildpacks, the first one, the one you&rsquo;re specifying will claim the build plan entries so the second one will end up being a no-op and doing nothing.</p>
<p>This example will switch in the GraalVM buildpack:</p>
<!-- raw HTML omitted -->
<div class="copyable">
    <pre class="copyable__code">pack build samples/native-image --buildpack paketo-buildpacks/graalvm --buildpack paketo-buildpacks/java-native-image`
</pre>
    <img class="copyable__clipboard" src="/images/clipboard.svg" alt="copy to clipboard" />
    <div class="copyable__copied copied">Copied!</div>
</div>
<!-- raw HTML omitted -->
<p>There is one drawback to this approach. When using the method above to specify an alternative Java Native Image Toolkit vendor buildpack, this alternate buildpack ends up running before the CA certs buildpack and therefore traffic from the alternate Java Native Image Toolkit vendor buildpack won’t trust any additional CA certs. This is not expected to impact many users because Java Native Image Toolkit buildpacks should reach out to URLs that have a cert signed by a known authority with a CA in the default system truststore.</p>
<p>If you have customized your Java Native Image Toolkit buildpack to download the Java Native Image Toolkit from a URL that uses a certificate not signed by a well-known CA, you can workaround this by specifying the CA certs buildpack to run first. This works because while you will end up with the CA certificates buildpack specified twice, the lifecycle is smart enough to drop the second one.</p>
<p>For example:</p>
<div class="copyable">
    <pre class="copyable__code">pack build samples/jar --buildpack paketo-buildpacks/ca-certificates --buildpack paketo-buildpacks/graalvm --buildpack paketo-buildpacks/java-native-image`
</pre>
    <img class="copyable__clipboard" src="/images/clipboard.svg" alt="copy to clipboard" />
    <div class="copyable__copied copied">Copied!</div>
</div>
<p>It does not hurt to use this command for all situations, it is just more verbose and most users can get away without specifying the CA certificates buildpack to be first.</p>
<h2 id="build-a-spring-boot-application" class="markup-heading">
    <a class="markup-heading__link" href="#build-a-spring-boot-application">
        Build a Spring Boot Application
    </a>
</h2><h3 id="inspect-spring-boot-application-dependencies" class="markup-heading">
    <a class="markup-heading__link" href="#inspect-spring-boot-application-dependencies">
        Inspect Spring Boot Application Dependencies
    </a>
</h3><p>The following command uses <code>pack</code> to list every dependency of a sample application.
<div class="copyable">
    <pre class="copyable__code">pack inspect-image samples/java --bom | jq &#39;.local[] | select(.name==&#34;dependencies&#34;) | .metadata.dependencies[].name&#39;
</pre>
    <img class="copyable__clipboard" src="/images/clipboard.svg" alt="copy to clipboard" />
    <div class="copyable__copied copied">Copied!</div>
</div></p>
<h3 id="disable-spring-boot-auto-configuration" class="markup-heading">
    <a class="markup-heading__link" href="#disable-spring-boot-auto-configuration">
        Disable Spring Boot Auto-Configuration
    </a>
</h3><p>The Spring Boot Buildpack adds <a href="https://github.com/spring-cloud/spring-cloud-bindings">Spring Cloud Bindings</a> to the application class path. Spring Cloud Bindings will auto-configure the application to connect to an external service when a binding of a supported type provides credentials and connection information at runtime. Runtime auto-configuration is enabled by default but can be disabled with the <code>BPL_SPRING_CLOUD_BINDINGS_DISABLED</code> environment variable at runtime or the <code>BP_SPRING_CLOUD_BINDINGS_DISABLED</code> environment variable at build time.</p>
<h2 id="connect-to-an-apm" class="markup-heading">
    <a class="markup-heading__link" href="#connect-to-an-apm">
        Connect to an APM
    </a>
</h2><p>The Java Buildpack supports the following <a href="https://en.wikipedia.org/wiki/Application_performance_management">APM</a> integrations:</p>
<ul>
<li><a href="https://docs.microsoft.com/en-us/azure/azure-monitor/app/app-insights-overview">Azure Application Insights</a> - support provided by the <a href="https://github.com/paketo-buildpacks/azure-application-insights">Azure Application Insights Buildpack</a></li>
<li><a href="https://cloud.google.com/products/operations">Google Stackdriver</a> - support provided by the <a href="https://github.com/paketo-buildpacks/google-stackdriver">Google Stackdriver Buildpack</a></li>
<li><a href="https://www.datadoghq.com/">Datadog</a> - support provided by the <a href="https://github.com/paketo-buildpacks/datadog">Datadog Buildpack</a></li>
</ul>
<p>The Azure Application Insights and Google Stackdriver APM integrations are enabled with <a href="https://paketo.io/docs/howto/configuration/#bindings">bindings</a>. If a binding of the correct <code>type</code> is provided at build-time the corresponding Java agent will be contributed to the application image. Connection credentials will be read from the binding at runtime.</p>
<p><strong>Example</strong>: Connecting to Azure Application Insights</p>
<p>The following command builds an image with the Azure Application Insights Java Agent
<div class="copyable">
    <pre class="copyable__code">pack build samples/java --volume &#34;$(pwd)/java/application-insights/binding:/platform/bindings/application-insights&#34;
</pre>
    <img class="copyable__clipboard" src="/images/clipboard.svg" alt="copy to clipboard" />
    <div class="copyable__copied copied">Copied!</div>
</div></p>
<p>To connect to Azure Application Insights at runtime a valid <a href="https://docs.microsoft.com/en-us/azure/azure-monitor/app/create-new-resource#copy-the-instrumentation-key">Instrumentation Key</a> is required.
<div class="copyable">
    <pre class="copyable__code">echo &#34;&lt;Instrumentation Key&gt;&#34; &gt; java/application-insights/binding/InstrumentationKey
docker run --rm --tty \
  --env SERVICE_BINDING_ROOT=/bindings \
  --volume &#34;$(pwd)/java/application-insights/binding:/bindings/app-insights&#34; \
  samples/java
</pre>
    <img class="copyable__clipboard" src="/images/clipboard.svg" alt="copy to clipboard" />
    <div class="copyable__copied copied">Copied!</div>
</div></p>
<p>The Datadog APM integration is enabled with an environment variable. If the environment variable is set then the corresponding Java agent will be contributed to the application image. Configuration will be read from standard Datadog environment variables set at runtime. You can find the full list in the Datadog documentation <a href="https://docs.datadoghq.com/tracing/setup_overview/setup/java/?tab=containers#configuration">available here</a>.</p>
<p><strong>Example</strong>: Connecting to Datadog</p>
<p>The following command builds an image with the Datadog Java Agent</p>
<div class="copyable">
    <pre class="copyable__code">pack build samples/java -e BP_DATADOG_ENABLED=true
</pre>
    <img class="copyable__clipboard" src="/images/clipboard.svg" alt="copy to clipboard" />
    <div class="copyable__copied copied">Copied!</div>
</div>
<p><a href="https://docs.datadoghq.com/tracing/setup_overview/setup/java/?tab=containers#configuration">Configuration of the Datadog agent</a> is done through environment variables at runtime:</p>
<!-- raw HTML omitted -->
<div class="copyable">
    <pre class="copyable__code">docker run --rm --tty samples/java -e DD_SERVICE=foo-service -e DD_ENV=foo-env -e DD_VERSION=1.1.1
</pre>
    <img class="copyable__clipboard" src="/images/clipboard.svg" alt="copy to clipboard" />
    <div class="copyable__copied copied">Copied!</div>
</div>
<!-- raw HTML omitted -->
<p>Note that the Datadog agent requires a side-car agent to be running in addition to the Java agent. This agent runs outside of the buildpack generated image. The <a href="https://docs.datadoghq.com/tracing/setup_overview/setup/java/?tab=containers#configure-the-datadog-agent-for-apm">standard Datadog instructions for your container orchestrator of choice</a> can be used to install this agent. The Paketo team also has detailed instructions for <a href="https://github.com/paketo-buildpacks/datadog/blob/main/docs/">various runtimes available here</a>.</p>
<h2 id="enable-process-reloading" class="markup-heading">
    <a class="markup-heading__link" href="#enable-process-reloading">
        Enable Process Reloading
    </a>
</h2><p>By default, Java will be the only process running in your container. This prohibits one from restarting Java within the container. If you need to be able to restart Java but not the whole container, perhaps to facilitate a shorter ‘inner loop’ for development, for quickly testing configuration changes or in conjunction with a tool like Tilt you may do so using the process reloading support.</p>
<p>To enable, set <code>BP_LIVE_RELOAD_ENABLED=true</code>. If <code>BP_LIVE_RELOAD_ENABLED</code> is true at build-time then the <a href="https://github.com/paketo-buildpacks/executable-jar">Executable Jar Buildpack</a> or the <a href="https://github.com/paketo-buildpacks/dist-zip">Dist Zip Buildpack</a> will request that <a href="https://github.com/watchexec/watchexec/"><code>watchexec</code></a> is installed and they will contribute a default process type named <code>reload</code>. This process type will use <code>watchexec</code> as the primary process and Java as a child process of <code>watchexec</code>.</p>
<p><strong>Example</strong>: Reloadable Process</p>
<p>The following commands build an image with a default reloadable process type.</p>
<div class="copyable">
    <pre class="copyable__code">pack build samples/java \
  --path java/jar \
  --env BP_LIVE_RELOAD_ENABLED=true
</pre>
    <img class="copyable__clipboard" src="/images/clipboard.svg" alt="copy to clipboard" />
    <div class="copyable__copied copied">Copied!</div>
</div>
<p>The output will confirm a <code>reload</code> process type has been added.</p>
<div class="copyable">
    <pre class="copyable__code">Paketo Executable JAR Buildpack v5.4.0
  https://github.com/paketo-buildpacks/executable-jar
  Class Path: Contributing to layer
    Writing env/CLASSPATH.delim
    Writing env/CLASSPATH.prepend
  Process types:
    executable-jar: java org.springframework.boot.loader.JarLauncher (direct)
    reload:         watchexec -r java org.springframework.boot.loader.JarLauncher (direct)
    task:           java org.springframework.boot.loader.JarLauncher (direct)
    web:            java org.springframework.boot.loader.JarLauncher (direct)
</pre>
    <img class="copyable__clipboard" src="/images/clipboard.svg" alt="copy to clipboard" />
    <div class="copyable__copied copied">Copied!</div>
</div>
<p>You may also run <code>pack inspect samples/java</code> which will show you the process types.</p>
<h3 id="using-tilt-with-paketo-buildpacks" class="markup-heading">
    <a class="markup-heading__link" href="#using-tilt-with-paketo-buildpacks">
        Using Tilt with Paketo Buildpacks
    </a>
</h3><p>You can use <a href="https://tilt.dev/">Tilt</a> with the Paketo Java Buildpacks. This uses the <a href="https://github.com/tilt-dev/tilt-extensions/tree/master/pack">Pack Tilt extension</a>. The example below shows how to use the pack extension and how to configure watched files.</p>
<p><strong>Example</strong>: Tilt</p>
<ol>
<li>Clone the official Tilt examples: <code>git clone https://github.com/tilt-dev/tilt-example-java</code></li>
<li><code>cd tilt-example-java/0-base</code></li>
<li>Modify your <code>Tiltfile</code> to look like this:</li>
</ol>
<!-- raw HTML omitted -->
<pre><code><div class="copyable">
    <pre class="copyable__code">    load(&#39;ext://pack&#39;, &#39;pack&#39;)

    pack(
        &#39;example-java-image&#39;,
        deps=[&#39;./bin/main&#39;],
        live_update = [
            sync(&#39;./bin/main&#39;, &#39;/workspace/BOOT-INF/classes&#39;),
        ],
    )
    k8s_yaml(&#39;kubernetes.yaml&#39;)
    k8s_resource(&#39;example-java&#39;, port_forwards=8000)
    </pre>
    <img class="copyable__clipboard" src="/images/clipboard.svg" alt="copy to clipboard" />
    <div class="copyable__copied copied">Copied!</div>
</div>
</code></pre>
<!-- raw HTML omitted -->
<ol start="4">
<li>
<p>Execute <code>tilt up</code>.</p>
</li>
<li>
<p>You should now be able to view your application running on your Kubernetes cluster by going to <code>http://localhost:8000</code> in your browser. In addition, if you edit files in your IDE, save and rebuild you should see those change live-reloaded into the application.</p>
</li>
</ol>
<h4 id="explanation-and-notes" class="markup-heading">
    <a class="markup-heading__link" href="#explanation-and-notes">
        Explanation and Notes
    </a>
</h4><p>The <code>Tiltfile</code> above will use the Pack Tilt extension, which in turn will run <code>pack build</code> to create an image from your application.</p>
<p>In addition, we configure Tilt to watch <code>./bin/main/**</code>. These files when modified will trigger an update in the container. The <code>live_update</code> block indicates which files locally will update and where they will be placed in the live container. We are instructing everything under <code>./bin/main</code> to be added into <code>/workspace/BOOT-INF/classes</code> when an update is triggered. This takes classes and resources compiled locally by an IDE and injects them into the location where application classes are stored in the container image.</p>
<p>This example is tuned for use with Visual Studio Code and its Java and Gradle extensions. These will compile code changes on save and put the compiled output in <code>./bin/main</code>. If you use a different IDE or Gradle/Maven directly, you will need to adjust the <code>deps</code> and <code>live_update</code> directories accordingly.</p>
<p>This functionality presently depends on the support of <a href="https://github.com/watchexec/watchexec/"><code>watchexec</code></a>. It is recommend that you read the section <a href="#enable-process-reloading">Enable Process Reloading</a> for further details.</p>
<h2 id="enable-remote-debugging" class="markup-heading">
    <a class="markup-heading__link" href="#enable-remote-debugging">
        Enable Remote Debugging
    </a>
</h2><p>If <code>BPL_DEBUG_ENABLED</code> is set to <code>true</code> at runtime the application will be configured to accept debugger connections. The debug port defaults to <code>8000</code> and can be configured with <code>BPL_DEBUG_PORT</code> at runtime. If <code>BPL_DEBUG_SUSPEND</code> is set at runtime, the JVM will suspend execution until a debugger has attached.</p>
<p><strong>Example</strong>: Remote Debugging</p>
<p>The following command builds a debug-enabled image.</p>
<div class="copyable">
    <pre class="copyable__code">pack build samples/java \
  --path java/jar
</pre>
    <img class="copyable__clipboard" src="/images/clipboard.svg" alt="copy to clipboard" />
    <div class="copyable__copied copied">Copied!</div>
</div>
<p>To run an image with the debug port published:
<div class="copyable">
    <pre class="copyable__code">docker run --env BPL_DEBUG_ENABLED=true --publish 8000:8000 samples/java
</pre>
    <img class="copyable__clipboard" src="/images/clipboard.svg" alt="copy to clipboard" />
    <div class="copyable__copied copied">Copied!</div>
</div></p>
<p>Connect your IDE debugger to connect to the published port.
<img src="/images/debug-eclipse.png" alt="Eclipse Remote Debug Configuration"></p>
<h2 id="enable-jmx" class="markup-heading">
    <a class="markup-heading__link" href="#enable-jmx">
        Enable JMX
    </a>
</h2><p>If <code>BPL_JMX_ENABLED</code> is set at runtime, the application will be configured to accept <a href="https://en.wikipedia.org/wiki/Java_Management_Extensions">JMX</a> connections. The JMX connector will listen on port <code>5000</code> by default. The port can be configured with the <code>BPL_JMX_PORT</code> environment variable at runtime.</p>
<p><strong>Example</strong>: Enabling JMX</p>
<p>The following command builds a JMX-enabled image.</p>
<div class="copyable">
    <pre class="copyable__code">pack build samples/java \
  --path java/jar
</pre>
    <img class="copyable__clipboard" src="/images/clipboard.svg" alt="copy to clipboard" />
    <div class="copyable__copied copied">Copied!</div>
</div>
<p>To run an image with the JMX port published:
<div class="copyable">
    <pre class="copyable__code">docker run --env BPL_JMX_ENABLED=true --publish 5000:5000 samples/java
</pre>
    <img class="copyable__clipboard" src="/images/clipboard.svg" alt="copy to clipboard" />
    <div class="copyable__copied copied">Copied!</div>
</div></p>
<p>Connect <a href="https://openjdk.java.net/tools/svc/jconsole/">JConsole</a> to the published port.
<img src="/images/jconsole.png" alt="JConsole"></p>
<h2 id="enable-java-native-memory-tracking-nmt" class="markup-heading">
    <a class="markup-heading__link" href="#enable-java-native-memory-tracking-nmt">
        Enable Java Native Memory Tracking (NMT)
    </a>
</h2><p>By default for Java 11+, the JVM will be configured to track internal memory usage. The JVM will print its last memory usage data when it exits, the level of detail can be configured at runtime by setting the environment variable <code>BPL_JAVA_NMT_LEVEL</code>, which supports both <code>summary</code> (default) and <code>detail</code>. Since there is a small amount of overhead required to support NMT, it can be disabled by setting the environment variable <code>BPL_JAVA_NMT_ENABLED</code> to <code>false</code>.</p>
<p><strong>Example</strong>: Capturing NMT output</p>
<p>To capture NMT data using the JDK tool <code>jcmd</code>, first ensure that you have a JDK installed at runtime (see <a href="#install-a-specific-jvm-type">Install a Specific JVM Type</a>).</p>
<p>Then run the following to start a bash session on a running container, with <code>jcmd</code> available on the $PATH variable:</p>
<div class="copyable">
    <pre class="copyable__code">docker exec -it &lt;container-id&gt; /cnb/lifecycle/launcher /bin/bash
</pre>
    <img class="copyable__clipboard" src="/images/clipboard.svg" alt="copy to clipboard" />
    <div class="copyable__copied copied">Copied!</div>
</div>
<p>From inside the new bash session, you can run the following to view the NMT data:</p>
<!-- raw HTML omitted -->
<div class="copyable">
    <pre class="copyable__code">jcmd 1 VM.native_memory summary
</pre>
    <img class="copyable__clipboard" src="/images/clipboard.svg" alt="copy to clipboard" />
    <div class="copyable__copied copied">Copied!</div>
</div>
<!-- raw HTML omitted -->
<p>The first argument should be the JVM PID, in the case of the Paketo Java buildpack, this will be <code>1</code>.</p>
<h3 id="java-nmt-and-java-8" class="markup-heading">
    <a class="markup-heading__link" href="#java-nmt-and-java-8">
        Java NMT and Java 8
    </a>
</h3><p>At the moment, there is <a href="https://github.com/paketo-buildpacks/bellsoft-liberica/issues/131">a bug in Java 8</a> that prevents Java NMT from being used. If you attempt to use it with Java 8 in a buildpack generated container, the JVM will crash on startup. The Java buildpack has disabled Java NMT when you are using Java 8, so users are not impacted by the bug. At the same time, it is not presently possible to enable Java NMT if you are running Java 8.</p>
<p>A fix for this issue has been submitted upstream to OpenJDK. It will take time for this fix to be accepted and picked up by all of the Java vendors. We are monitoring this situation, and as Java vendors pick up this fix we will re-enable Java NMT support for Java 8 users in the buildpack.</p>
<h3 id="java-nmt-and-reloadable-processes" class="markup-heading">
    <a class="markup-heading__link" href="#java-nmt-and-reloadable-processes">
        Java NMT and Reloadable Processes
    </a>
</h3><p>Java NMT support does not work with <a href="#enable-process-reloading">Reloadable Processes</a>. This is because when using reloadable processes, the JVM PID is not 1 and not easily determinable by the buildpack Java NMT helper. Thus the helper cannot set the environment variables required by the JVM to enable Java NMT.</p>
<p>If you attempt to enable Java NMT and are using Reloadable Processes, that&rsquo;s OK. The JVM will not enable Java NMT and it will output the following messages.</p>
<!-- raw HTML omitted -->
<div class="copyable">
    <pre class="copyable__code">OpenJDK 64-Bit Server VM warning: Native Memory Tracking did not setup properly, using wrong launcher?
OpenJDK 64-Bit Server VM warning: PrintNMTStatistics is disabled, because native memory tracking is not enabled
</pre>
    <img class="copyable__clipboard" src="/images/clipboard.svg" alt="copy to clipboard" />
    <div class="copyable__copied copied">Copied!</div>
</div>
<!-- raw HTML omitted -->
<p>Your application should continue to run, but with Java NMT disabled.</p>
<h2 id="enable-java-flight-recorder-jfr" class="markup-heading">
    <a class="markup-heading__link" href="#enable-java-flight-recorder-jfr">
        Enable Java Flight Recorder (JFR)
    </a>
</h2><p>If <code>BPL_JFR_ENABLED</code> is set to <code>true</code> at runtime, Java Flight Recording features will be enabled by the JVM. To configure JFR via <a href="https://docs.oracle.com/javacomponents/jmc-5-4/jfr-runtime-guide/run.htm#JFRUH178">its supported arguments</a>, add them to the optional environment variable <code>BPL_JFR_ARGS</code> at runtime.</p>
<p>Two default arguments are configured for JFR as follows:</p>
<ul>
<li><code>dumponexit</code> - this is set to <code>true</code> to write the recording data to a file when the JVM exits</li>
<li><code>filename</code> - this is set to <code>&lt;system-temp-dir&gt;/recording.jfr</code> (i.e. <code>/tmp/recording.jfr</code>) and is the location where the recording data will be written on JVM exit</li>
</ul>
<p>If any args are provided via <code>BPL_JFR_ARGS</code>, these defaults will not be configured.</p>
<p><strong>Example</strong>: Enabling &amp; configuring JFR</p>
<p>The following command builds a JFR-enabled image.</p>
<div class="copyable">
    <pre class="copyable__code">pack build samples/java \
  --path java/jar
</pre>
    <img class="copyable__clipboard" src="/images/clipboard.svg" alt="copy to clipboard" />
    <div class="copyable__copied copied">Copied!</div>
</div>
<p>To run an image with JFR enabled and optionally configure it with custom arguments:</p>
<div class="copyable">
    <pre class="copyable__code">docker run --env BPL_JFR_ENABLED=true --env BPL_JFR_ARGS=filename=/tmp/my-recording.jfr,duration=60s samples/java
</pre>
    <img class="copyable__clipboard" src="/images/clipboard.svg" alt="copy to clipboard" />
    <div class="copyable__copied copied">Copied!</div>
</div>
<h2 id="append-arguments-to-the-apps-start-command" class="markup-heading">
    <a class="markup-heading__link" href="#append-arguments-to-the-apps-start-command">
        Append Arguments to the App&rsquo;s Start Command
    </a>
</h2><p>Additional arguments can be provided to the application using the container <a href="https://github.com/opencontainers/image-spec/blob/master/config.md#properties"><code>CMD</code></a>. In Kubernetes set <code>CMD</code> using the <code>args</code> field on the <a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.19/#container-v1-core">container</a> resource.</p>
<p><strong>Example</strong>: Setting the Server Port</p>
<p>Execute the following command passes an additional argument to application start command, setting the port to <code>8081</code>.
<div class="copyable">
    <pre class="copyable__code">docker run --rm --publish 8081:8081 samples/java --server.port=8081
curl -s http://localhost:8081/actuator/health
</pre>
    <img class="copyable__clipboard" src="/images/clipboard.svg" alt="copy to clipboard" />
    <div class="copyable__copied copied">Copied!</div>
</div></p>
<h2 id="provide-a-custom-start-command-at-launch" class="markup-heading">
    <a class="markup-heading__link" href="#provide-a-custom-start-command-at-launch">
        Provide a Custom Start Command at Launch
    </a>
</h2><p>To override the buildpack-provided start command with a custom command, set the container <a href="https://github.com/opencontainers/image-spec/blob/master/config.md#properties"><code>ENTRYPOINT</code></a></p>
<p><strong>Example</strong>: Starting an Interactive Shell</p>
<p>The following command runs Bash interactively:
<div class="copyable">
    <pre class="copyable__code">docker run --rm --entrypoint bash samples/java
</pre>
    <img class="copyable__clipboard" src="/images/clipboard.svg" alt="copy to clipboard" />
    <div class="copyable__copied copied">Copied!</div>
</div></p>
<h3 id="execute-a-custom-command-in-the-buildpack-provided-environment" class="markup-heading">
    <a class="markup-heading__link" href="#execute-a-custom-command-in-the-buildpack-provided-environment">
        Execute a Custom Command in the Buildpack-Provided Environment
    </a>
</h3><p>Every buildpack-generated image contains an executable called the <code>launcher</code> which can be used to execute a custom command in an environment containing buildpack-provided environment variables. The <code>launcher</code> will execute any buildpack provided profile scripts before running to provided command, in order to set environment variables with values that should be calculated dynamically at runtime.</p>
<p>To run a custom start command in the buildpack-provided environment set the <code>ENTRYPOINT</code> to <code>launcher</code> and provide the command using the container <code>CMD</code>.</p>
<p><strong>Example</strong>: Inspecting the Buildpack-Provided <code>JAVA_TOOL_OPTIONS</code>
The following command will print value of <code>$JAVA_TOOL_OPTIONS</code> set by the buildpack:
<div class="copyable">
    <pre class="copyable__code">docker run --rm --entrypoint launcher samples/java echo &#39;JAVA_TOOL_OPTIONS: $JAVA_TOOL_OPTIONS&#39;
</pre>
    <img class="copyable__clipboard" src="/images/clipboard.svg" alt="copy to clipboard" />
    <div class="copyable__copied copied">Copied!</div>
</div></p>
<p>Each argument provided to the launcher will be evaluated by the shell prior to execution and the original tokenization will be preserved. Note that, in the example above <code>'JAVA_TOOL_OPTIONS: $JAVA_TOOL_OPTIONS'</code> is single quoted so that <code>$JAVA_TOOL_OPTIONS</code> is evaluated in the container, rather than by the host shell.</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->

            </div>
            
  <a href="https://github.com/paketo-buildpacks/paketo-website/edit/main/content/docs/howto/java.md" target="_blank" class="github-edit" style="text-decoration:none">
    <div class="github-edit__content">
      <div class="github-edit__logo-container">
        <img class="github-edit__logo" src="/images/github-mark.png">
      </div>
        <div class="github-edit__text">Edit</div>
    </div>
</a>

            <p class="docs-mod-time"><strong>Last modified:</strong> July 18, 2022</p>
        </div>
        
<div class="docs-body__table-of-contents-container docs-body__table-of-contents-container--desktop">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#about-the-examples">About the Examples</a></li>
    <li><a href="#build-an-app-as-a-traditional-java-war-or-jar">Build an App as a Traditional Java WAR or JAR</a>
      <ul>
        <li><a href="#build-from-source">Build from Source</a></li>
        <li><a href="#build-from-a-compiled-artifact">Build from a Compiled Artifact</a></li>
        <li><a href="#inspect-the-jvm-version">Inspect the JVM Version</a></li>
        <li><a href="#install-a-specific-jvm-version">Install a Specific JVM Version</a></li>
        <li><a href="#install-a-specific-jvm-type">Install a Specific JVM Type</a></li>
        <li><a href="#configure-the-jvm-at-runtime">Configure the JVM at Runtime</a></li>
        <li><a href="#use-an-alternative-jvm">Use an Alternative JVM</a></li>
        <li><a href="#use-an-alternative-java-application-server">Use an Alternative Java Application Server</a></li>
      </ul>
    </li>
    <li><a href="#build-an-app-as-a-graalvm-native-image-application">Build an App as a GraalVM Native Image Application</a>
      <ul>
        <li><a href="#build-from-source-1">Build From Source</a></li>
        <li><a href="#build-from-an-executable-jar">Build From an Executable JAR</a></li>
        <li><a href="#inspect-the-native-image-tools-version">Inspect the Native Image Tools Version</a></li>
        <li><a href="#configure-the-graalvm-version">Configure the GraalVM Version</a></li>
        <li><a href="#use-an-alternative-java-native-image-toolkit">Use an Alternative Java Native Image Toolkit</a></li>
      </ul>
    </li>
    <li><a href="#build-a-spring-boot-application">Build a Spring Boot Application</a>
      <ul>
        <li><a href="#inspect-spring-boot-application-dependencies">Inspect Spring Boot Application Dependencies</a></li>
        <li><a href="#disable-spring-boot-auto-configuration">Disable Spring Boot Auto-Configuration</a></li>
      </ul>
    </li>
    <li><a href="#connect-to-an-apm">Connect to an APM</a></li>
    <li><a href="#enable-process-reloading">Enable Process Reloading</a>
      <ul>
        <li><a href="#using-tilt-with-paketo-buildpacks">Using Tilt with Paketo Buildpacks</a></li>
      </ul>
    </li>
    <li><a href="#enable-remote-debugging">Enable Remote Debugging</a></li>
    <li><a href="#enable-jmx">Enable JMX</a></li>
    <li><a href="#enable-java-native-memory-tracking-nmt">Enable Java Native Memory Tracking (NMT)</a>
      <ul>
        <li><a href="#java-nmt-and-java-8">Java NMT and Java 8</a></li>
        <li><a href="#java-nmt-and-reloadable-processes">Java NMT and Reloadable Processes</a></li>
      </ul>
    </li>
    <li><a href="#enable-java-flight-recorder-jfr">Enable Java Flight Recorder (JFR)</a></li>
    <li><a href="#append-arguments-to-the-apps-start-command">Append Arguments to the App&rsquo;s Start Command</a></li>
    <li><a href="#provide-a-custom-start-command-at-launch">Provide a Custom Start Command at Launch</a>
      <ul>
        <li><a href="#execute-a-custom-command-in-the-buildpack-provided-environment">Execute a Custom Command in the Buildpack-Provided Environment</a></li>
      </ul>
    </li>
  </ul>
</nav>
</div>

    </div>
</div>


    <footer class="footer text--light">
    <div class="footer-social-links-container">
        <a class="footer-social-link" href="https://twitter.com/Paketo_io">
            <div class="footer-social-link__image-container">
                <div class="logo">
                    <img class="logo__image" src="/v2/images/logo-twitter.svg" alt="Blue Twitter bird logo">
                </div>
            </div>
            <div class="text--light text--400">
                Twitter
            </div>
        </a>
        <a class="footer-social-link" href="https://slack.paketo.io/">
            <div class="footer-social-link__image-container">
                <div class="logo">
                    <img class="logo__image" src="/v2/images/logo-slack.svg" alt="Slack logo">
                </div>
            </div>
            <div class="text--light text--400">
                Slack
            </div>
        </a>
        <a class="footer-social-link" href="https://github.com/paketo-buildpacks">
            <div class="footer-social-link__image-container">
                <div class="logo logo--github">
                    <img class="logo__image"  src="/v2/images/logo-github-cropped.svg" alt="GitHub Octocat logo"/>
                </div>
            </div>
            <div class="text--light text--400">
                GitHub
            </div>
        </a>
    </div>
    <div class="footer-privacy-policy">
        <div class="footer-text--small">Paketo Buildpacks is a <a class="text--light" href="https://www.cloudfoundry.org/">Cloud Foundry</a> Project</div>
        <img class="cloudfoundry-logo" src="/v2/images/logo-cloudfoundry-light.svg" alt="Cloud Foundry logo" />
        <a class="footer-text--small text--light" href="https://linuxfoundation.org/privacy-policy/">Privacy Policy</a>
    </div>
</footer><script src="/js/main.2058faab5af4053fab9973d7412fb4eb461294e03b846664ec7335d3f7f8795e.js"></script>

    <div id="footer-skip-link" class="screenreader-container">
    <a href="#header-skip-link" class="screenreader-text">Skip to Header</a>
</div>

</body>

</html>
